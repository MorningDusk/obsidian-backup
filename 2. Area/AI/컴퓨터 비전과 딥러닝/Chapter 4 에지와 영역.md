---
date: 2025-06-09
tags:
  - ai
  - computer_vision
  - deep_learning
---
# 1. 에지 검출
**에지 검출** 알고리즘은 물체 내부의 명암이 서서히 변하고 물체 경계의 명암이 급격히 변하는 특성을 활용한다.
## 1.1. 영상의 미분
미분은 변수 $x$의 값이 미세하게 증가했을 때 함수의 변화량을 측정한다.
$$
f'(x)=\lim_{\delta x \rightarrow 0} \frac{f(x+\delta x)-f(x)}{\delta x}
$$
디지털 영상에서는 $x$의 최소 변화량이 1이므로 $\delta x=1$로 한다. 아래 식을 영상 $f$에 적용하는 일은 필터 $u$로 컨볼루션하여 구현한다. 필터 $u$의 중심점은 왼쪽 화소이며 $u$를 에지 **연산자**<sub>edge operator</sub>라고 한다.
$$
f'(x)=\frac{f(x+\delta x)-f(x)}{\delta x}=f(x+1)-f(x)
$$
![[Pasted image 20250716214112.png]]
## 1.2. 에지 연산자
위 그림에서는 컨볼루션으로 구한 미분 연산 f’는 명암 변화가 없는 곳은 0, 명암 변화가 급격한 부분은 3을 가진다. 하지만 현실 영상은 물체 경계에서 명암 변화가 계단 모양이 아니다.
### 현실 세계의 램프 에지
현실에서는 아래 그림처럼 명암이 몇 화소에 걸쳐 변하는 램프 에지<sub>lamp edge</sub>가 발생한다. 컨볼루션으로 구한 1차 미분 영상을 보면 1보다 큰 에지, 즉 에지의 정확한 위치를 정하는 위치 찾기<sub>localization</sub> 문제가 생겼다.
![[Pasted image 20250716215224.png]]
위 그림은 $u$로 컨볼루션한 영상을 $u$로 한 번 더 컨볼루션한 영상을 보여준다. 하지만 아래 식에 따라 연산자를 설계하면 한 번의 컨볼루션으로 구할 수 있다.
$$
\begin{align}
f''(x)=\frac{f'(x)-f'(x-\delta)}{\delta}=f'(x)-f'(x-1) \\ =(f(x+1)-f(x))-(f(x)-f(x-1)) \\ = f(x+1)-2f(x)+f(x-1)
\end{align}
$$
위 그림을 살펴보면 1차 미분 영상은 에지에서 봉우리가 발생하고 2차 미분 영상은 영교차<sub>zero crossing</sub>가 발생한다. 영교차란 왼쪽과 오른쪽에 부호가 다른 반응이 나타나고 자신은 0을 갖는 위치를 뜻한다.
![[Pasted image 20250716220947.png]]
### 1차 미분에 기반한 에지 연산자
아래 식은 1차원에서 설계한 연산자를 2차원으로 확장한다. 따라서 $x$ 방향과 $y$ 방향의 두 연산자를 사용한다.
